[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "book",
    "section": "",
    "text": "1 Overview\nThis book is a curated index of analyses and reports related to:\n\nForest structure\nLiDAR-derived metrics\nWood density databases\nBiomass estimation\n\nEach report was produced independently and is available as a standalone HTML document.",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "../tree_height_from_lidar_all_apus.html",
    "href": "../tree_height_from_lidar_all_apus.html",
    "title": "1¬† Workflow to extract tree height from Lidar CHM",
    "section": "",
    "text": "2 This script\nThis is the final script to extract tree height from a Canopy Height Model (CHM) generated from LiDAR-derived point clouds in a forest management area. Two CHMs will be used: one from the year before harvesting and one from the year after. The path to the CHM of each area will be provided in a table.\nThe Forest Inventory of the area will also be used. The goal is to identify the crown of the harvested tree and obtain its height from the CHM metrics.",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Workflow to extract tree height from Lidar CHM</span>"
    ]
  },
  {
    "objectID": "../tree_height_from_lidar_all_apus.html#parameters",
    "href": "../tree_height_from_lidar_all_apus.html#parameters",
    "title": "1¬† Workflow to extract tree height from Lidar CHM",
    "section": "4.1 Parameters",
    "text": "4.1 Parameters\nThen we set the script parameters.\nlim_inf = Percentage points threshold to be considered as a gap. When subtracting two CHMs the output difference can be full of noises (a branch that broke or moved for example). Setting a threshold ensures we will select only the large differences.\npol_area = Minimum area to be considered as a gap (m2).\nprojection = Projection of spatial data.\nbuffer_size = Buffer size around each tree to avoid confusing very close trees and also to identify the associated gap.\npercentil = Percentile used to extract maximum height in the identified canopy area.\n\nlim_inf &lt;- 0.05\n\npol_area &lt;- 25\n\nprojection &lt;- \"EPSG:31980\"\n\nbuffer_size &lt;- 20\n\npercentil &lt;- 0.95",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Workflow to extract tree height from Lidar CHM</span>"
    ]
  },
  {
    "objectID": "../tree_height_from_lidar_all_apus.html#chm-processing",
    "href": "../tree_height_from_lidar_all_apus.html#chm-processing",
    "title": "1¬† Workflow to extract tree height from Lidar CHM",
    "section": "6.1 CHM processing",
    "text": "6.1 CHM processing\nRead the table with the file path of each CHM before and after exploitation for each APU.\n\nchm_list &lt;- read.csv(here(\"data/chm/APUs_CHMs.csv\"))\n\nchm_list &lt;-chm_list[chm_list$before_exploit != \"\", ]\n\nif100_romaneio &lt;- read.csv(here(\"data/forest_inventory/if100_com_romaneio.csv\"))\n\nLet‚Äôs loop it\n\nfor (i in 1:length(chm_list)) {\n  \nupa &lt;- chm_list$apu[i]\n  \numf &lt;- chm_list$fmu[i]\n  \nlid.antes &lt;- chm_list$before_exploit[i]\n  \nlid.depois &lt;- chm_list$after_exploit[i]\n\nstopifnot(file.exists(lid.antes))\n\nstopifnot(file.exists(lid.depois))\n\nr1 &lt;- rast(lid.antes)\nr2 &lt;- rast(lid.depois)\n\nif (crs(r1) != projection) r1 &lt;- project(r1, projection)\nif (crs(r2) != projection) r2 &lt;- project(r2, projection)\n  \next_intersect &lt;- terra::intersect(ext(r1), ext(r2))\n\nr1_crop &lt;- crop(r1, \n                ext_intersect)\nr2_crop &lt;- crop(r2, \n                ext_intersect)\n\ndiff_raster &lt;- r2_crop - r1_crop\n\ndiff_raster &lt;- mask(diff_raster, \n                    (!is.na(r1_crop) & !is.na(r2_crop)))\n  \nq1 &lt;- quantile(values(diff_raster), \n               probs = lim_inf, \n               na.rm = TRUE)\n\nr_low &lt;- diff_raster\nr_low[diff_raster &gt; q1] &lt;- NA\nr_low[!is.na(r_low)] &lt;- 1\n\nr_low_patches &lt;- patches(r_low, directions = 8)\npoly_low &lt;- as.polygons(r_low_patches, \n                        dissolve = T, \n                        na.rm = TRUE)\n\ncrs(poly_low) &lt;- projection\n\npoly_low$area_m2 &lt;- expanse(poly_low, \n                            unit = \"m\")\n\npoly_filtrado &lt;- poly_low[poly_low$area_m2 &gt; pol_area, ]\n\n\nupa.umf &lt;- paste0(\"Jamari_\",\n                  \"UMF_\",\n                  umf,\n                  \"_UPA_\",\n                  upa)\n\n\nif100_upa &lt;- if100_romaneio %&gt;%\n                  filter(codigo == upa.umf)\n \nif (all(is.na(if100_upa$vol_tora))) {\n                                      message(\"Volume de tora igual a zero na itera√ß√£o \", i)\n                                      next\n                                    }\n\nif100_upa &lt;- if100_upa[!is.na(if100_upa$vol_tora), ]\n\nif100_pts &lt;- vect(if100_upa, \n                  geom = c(\"lon\", \"lat\"),\n                  keepgeom = TRUE,\n                  crs = \"EPSG:4674\")\n\ncrs(if100_pts) &lt;- \"EPSG:4674\"\n\nif100_pts &lt;- project(if100_pts, \n                     projection)\n\nif100_pts &lt;- crop(if100_pts, \n                  diff_raster)\n\nif100_pts$ID &lt;- 1:nrow(if100_pts)\n\nbuffer_if100 &lt;- buffer(if100_pts,\n                       width = buffer_size)\n\ntoca &lt;- relate(buffer_if100, \n               buffer_if100, \n               \"overlaps\")\n\ndiag(toca) &lt;- FALSE\n\ntocam_outros &lt;- apply(toca, 1, any)\n\nb_isolados &lt;- buffer_if100[!tocam_outros]\n\npts_sel &lt;- if100_pts[ if100_pts$id_arv %in% b_isolados$id_arv , ]\n\nsel &lt;- relate(poly_filtrado, \n              b_isolados, \n              \"intersects\")\n\nlista_copas &lt;- apply(sel, \n                     2, \n                     function(x) which(x))\n\nidx_mantidos &lt;- c()\n\nfor (o in seq_along(lista_copas)) {\n  \n  copas_idx &lt;- lista_copas[[o]]\n  \n  if (length(copas_idx) == 0) next\n  \n  if (length(copas_idx) == 1) {\n    idx_mantidos &lt;- c(idx_mantidos, \n                      copas_idx)\n    next\n  }\n  \n  distancias &lt;- distance(\n    pts_sel[o, ],\n    poly_filtrado[copas_idx, ]\n  )\n  \n\n  idx_melhor &lt;- copas_idx[ which.min(distancias) ]\n  idx_mantidos &lt;- c(idx_mantidos, \n                    idx_melhor)\n}\n\n\nidx_mantidos &lt;- unique(idx_mantidos)\n\nidx_mantidos &lt;- idx_mantidos[!is.na(idx_mantidos)]\n\nif (length(idx_mantidos) == 0){\n                                message(\"Pulando itera√ß√£o \", i, \": idx_mantidos √© NA\")\n                                next\n                              }\n\npol_copas_sel &lt;- poly_filtrado[idx_mantidos, ]\n\n\nm &lt;- relate(pol_copas_sel, b_isolados, \"intersects\")\n\nidx &lt;- apply(m, \n             1, \n             function(x) ifelse(any(x), \n                                which(x)[1], \n                                NA))\n\npol_copas_sel$ID_B &lt;- b_isolados$ID[idx]\n\n\nvalores &lt;- terra::extract(r1, \n                          pol_copas_sel)\n\nvalores &lt;- na.omit(valores)\n\ncolnames(valores) &lt;- c(\"id_pol\", \"z\")\n\nstats &lt;- valores %&gt;%\n  group_by(id_pol) %&gt;%\n  summarise(z_lidar = quantile(z, \n                             percentil, \n                             na.rm = TRUE))\n\npol_copas_sel$z_lidar &lt;- stats$z_lidar\n\nif100_pts_df &lt;- as.data.frame(if100_pts)\npol_copas_sel_df &lt;- as.data.frame(pol_copas_sel)\n\nif100_pts_z &lt;- left_join(if100_pts_df, \n                         pol_copas_sel_df, \n                         by = c(\"ID\" = \"ID_B\"))\n\nwrite.csv(if100_pts_z,\n          file = paste0(here(\"data/output\"),\n                        \"/Jamari\",\n                        \"_FMU_\",\n                        umf,\n                        \"_APU_\",\n                        upa,\n                        \"_if100_pts_z.csv\"))\n\n}\n\nAnd now we merge all the outputs tables\n\nlist_csv &lt;- list.files(here(\"data/output/\"),\n                       \"*pts_z.csv$\",\n                       full.names = T)\n\nall_tables &lt;- do.call(rbind,\n                    lapply(list_csv,\n                           read.csv,\n                           stringsAsFactors = FALSE)\n                    )\n\nwrite.csv(all_tables,\n          paste0(here(\"data/output\"),\n                 \"/\",\n                 \"all_tables.csv\")\n          )\n\nmessage(sum(!is.na(all_tables$z_lidar)), \" tree heights were estimated from LiDAR data.\")\n\n798 tree heights were estimated from LiDAR data.\n\n\nLet‚Äôs take a look to the data distribution\n\nggplot(all_tables, aes(x = z_lidar)) +\n  geom_histogram(binwidth = 1, na.rm = TRUE,\n                 fill = \"steelblue\", color = \"black\") +\n  theme_minimal() +\n  labs(\n    title = paste0(sum(!is.na(all_tables$z_lidar)),\" Lidar heights\"),\n    x = \"LiDAR height (m)\",\n    y = \"Frequency\"\n  )\n\n\n\n\n\n\n\nggplot(all_tables, \n       aes(x = dap, \n           y = z_lidar)) +\n  geom_point(alpha = 0.7, \n             aes(color = nome_cientifico),\n             show.legend = F) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\",\n              formula = 'y ~ 0 + x') +\n  theme_minimal() +\n  labs(\n    title = \"DBH x Lidar height\",\n    x = \"DBH (cm)\",\n    y = \"Lidar height (m)\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"),\n    legend.title = element_text(face = \"bold\")\n  ) +\n  ggpubr::stat_regline_equation(formula = 'y ~ 0 + x')\n\n\n\n\n\n\n\n\n\n\n\n\nFischer, Fabian J√∂rg, Toby Jackson, Gr√©goire Vincent, and Tommaso Jucker. 2024. ‚ÄúRobust Characterisation of Forest Structure from Airborne Laser Scanning‚Äîa Systematic Assessment and Sample Workflow for Ecologists.‚Äù Methods in Ecology and Evolution 15 (October): 1873‚Äì88. https://doi.org/10.1111/2041-210X.14416.",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Workflow to extract tree height from Lidar CHM</span>"
    ]
  },
  {
    "objectID": "../wood_density_databases.html",
    "href": "../wood_density_databases.html",
    "title": "2¬† Comparing wood density databases",
    "section": "",
    "text": "3 Setup\n\nlibrary(here)\nlibrary(dplyr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(readr)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(BIOMASS)\n\n\n\n4 Comparing different wood databases\nThis script will compare biomass estimations with different wood density databases. We will use Global Wood Database (Chave et al. 2009), from the package BIOMASS and the Brazilian Woods Database (https://lpf.florestal.gov.br/en-us/brazilian-woods). BWD has many samples collected in Jamari Forest, as we can see below. We obtained the basic wood density information (g/m¬≥) and the sample collection location for each species from the BWD website. There is no specific coordinate for the sampling location; therefore, we assigned a central coordinate to each collection location in order to determine the geographic region of origin of the sample.\n\nbwd &lt;- read.csv(here(\"data/wood_density/tabela_densidade_coordenadas.csv\"))\n\nbwd_clean &lt;- bwd %&gt;%\n  filter(!is.na(long), !is.na(lat))\n\npts_bwd &lt;- st_as_sf(\n  bwd_clean,\n  coords = c(\"long\", \"lat\"),\n  crs = 4326   # WGS84 (graus decimais)\n)\n\npts_bwd_count &lt;- pts_bwd %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  group_by(X, Y) %&gt;%\n  summarise(n = n()) %&gt;%\n  ungroup() %&gt;%\n  st_as_sf(coords = c(\"X\", \"Y\"), crs = st_crs(pts_bwd))\n\n`summarise()` has grouped output by 'X'. You can override using the `.groups`\nargument.\n\nbrasil &lt;- ne_countries(\n  scale = \"medium\",\n  country = \"Brazil\",\n  returnclass = \"sf\"\n)\n\n# ggplot() +\n#   geom_sf(data = brasil, fill = \"gray95\", color = \"gray40\") +\n#   geom_sf(data = pts_bwd, color = \"red\", size = 2, alpha = 0.7) +\n#   coord_sf() +\n#   theme_minimal() +\n#   labs(\n#     title = \"Brazilian woods database samples locations\",\n#     x = \"Longitude\",\n#     y = \"Latitude\"\n#   )\n\nggplot() +\n  geom_sf(data = brasil, \n          fill = \"gray95\", \n          color = \"gray40\") +\n  geom_sf(data = pts_bwd_count, \n          aes(size = n), \n          color = \"red\", \n          alpha = 0.7) +\n  geom_text_repel(\n    data = pts_bwd_count,\n    aes(label = n, \n        geometry = geometry),\n    stat = \"sf_coordinates\",\n    size = 3,\n    min.segment.length = 0\n  ) +\n  scale_size_continuous(name = \"Number of samples\") +\n  coord_sf() +\n  theme_minimal() +\n  labs(\n    title = paste(\"Brazilian woods database samples locations (\",\n                  nrow(pts_bwd),\n                  \"samples ).\"),\n            x = \"Longitude\",\n            y = \"Latitude\"\n  )\n\nWarning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not\ngive correct results for longitude/latitude data\n\n\n\n\n\n\n\n\n\n\n\n5 Estimating biomass with BWD\nWe will use permanent plots measurements from Jamari National Forest. The Wood density estimates presented here are only for species the species present in the permanent plots.\nIn BWD there are multiple samples for the same species. We calculated mean basic wood density for each species with multiple samples. Then we converted bwd table to BIOMASS wood density table format.\nWe retrieved wood density from Gobal Wood Database (Chave et al. 2009) using BIOMASS.\n\npps &lt;- read.csv(here(\"data/pp/tabelao_pps.csv\"))\n\nmessage(\"Permanent plots of APUs: \\n\",paste(unique(paste(pps$UMF,\n                                                         pps$UPA)),\n                                                         collapse = \"\\n\"\n                                                         ))\n\nPermanent plots of APUs: \nUMF_I UPA_1\nUMF_I UPA_10\nUMF_I UPA_13\nUMF_I UPA_2\nUMF_I UPA_3\nUMF_I UPA_4\nUMF_I UPA_5\nUMF_I UPA_6\nUMF_I UPA_7\nUMF_I UPA_8\nUMF_I UPA_9\nUMF_IV UPA_15\n\nmessage(\"Years of measurement:\\n\",paste(unique(pps$p23_cdmedicao),\n                                         collapse = \"\\n\"))\n\nYears of measurement:\n2010\n2013\n2016\n2018\n2021\n2015\n2017\n2023\n2020\n2022\n2011\n2012\n2014\n2019\n\nbwd &lt;- bwd %&gt;%\n  group_by(nome_cientifico) %&gt;%\n  summarise(mean_wd = mean(densidade_basica), \n            .groups = \"drop\")\n\nbwd_biomass &lt;- bwd %&gt;%\n  tidyr::separate(\"nome_cientifico\",\n                  c(\"genero\",\"epiteto\"),\n                  \" \")\nnames(bwd_biomass) &lt;- c(\"genus\",\"species\",\"wd\")\n\nmessage(\"BWD has wood density of \", \n        length(unique(bwd$nome_cientifico)),\n        \" species.\")\n\nBWD has wood density of 275 species.\n\ntaxo &lt;- correctTaxo(genus=pps$genero,\n                    species=pps$epiteto,\n                    useCache = T)\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |======================================================================| 100%\n\n\nCache updated\n\n\nSource iplant_tnrs:41090\n\n\nCorrections TaxaNotFound:10183, FALSE:21919, TRUE:1336, SpNotFound:7652\n\nw_density &lt;- getWoodDensity(genus = taxo$genusCorrected,\n                            species = taxo$speciesCorrected)\n\nThe reference dataset contains 16467 wood density values\n\n\nYour taxonomic table contains 106 taxa\n\ndensidades &lt;- bwd_biomass %&gt;%\n                  inner_join(w_density,\n                  by = c(\"genus\",\n                         \"species\")) %&gt;%\n                  select(genus,\n                         species,\n                         WD_global = meanWD,\n                         WD_brazil = wd)\n\ndensidades &lt;- unique(densidades)\n\nggplot(densidades, aes(x = WD_global, \n                       y = WD_brazil)) +\n  geom_point(alpha = 0.7) +\n  geom_abline(slope = 1, \n              intercept = 0, \n              linetype = \"dashed\") +\n  labs(\n    x = \"Global Wood density database\",\n    y = \"Brazilian Woods density database\",\n    title = paste(\"Comparison of wood density estimates for\",\n                  nrow(densidades),\n                  \"species between BWD and GWD\")\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nWe can use Bland-Altman graphic to see differences between wood density databases. I will highlight species that are out of limits of agreement.\n\ndensidades$mean_density &lt;- (densidades$WD_global + densidades$WD_brazil) / 2\ndensidades$diff_density &lt;- densidades$WD_global - densidades$WD_brazil\n\nbias &lt;- mean(densidades$diff_density, \n             na.rm = TRUE)\nsd_diff &lt;- sd(densidades$diff_density, \n              na.rm = TRUE)\n\nloa_inf &lt;- bias - 1.96 * sd_diff\nloa_sup &lt;- bias + 1.96 * sd_diff\n\ndensidades &lt;- densidades %&gt;%\n                 mutate(fora_loa = diff_density &lt; loa_inf | diff_density &gt; loa_sup)\n\ndensidades$especie &lt;- paste(densidades$genus,\n                            densidades$species,\n                            sep = \" \")\n\nggplot(densidades, aes(x = mean_density, \n                       y = diff_density,\n                       color = especie)) +\n  geom_point(alpha = 0.7) +\n  geom_hline(yintercept = mean(densidades$diff_density,\n                               na.rm = TRUE),\n             linetype = \"dashed\") +\n  geom_hline(yintercept = mean(densidades$diff_density,\n                               na.rm = TRUE) +\n                           1.96 * sd(densidades$diff_density,\n                                     na.rm = TRUE),\n             linetype = \"dotted\") +\n  geom_hline(yintercept = mean(densidades$diff_density,\n                               na.rm = TRUE) -\n                           1.96 * sd(densidades$diff_density,\n                                     na.rm = TRUE),\n             linetype = \"dotted\") +\n    geom_text_repel(\n    data = subset(densidades, fora_loa),\n    aes(label = especie),\n    size = 3,\n    show.legend = FALSE\n  ) +\n  labs(\n    x = \"Mean wood density\",\n    y = \"Difference between methods\",\n    title = \"Bland‚ÄìAltman: wood density databases\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nLet‚Äôs see the difference in biomass estimation.\nTotal tree height was obtained using the retrieveH function from the BIOMASS package, based on the central coordinates of the Jamari National Forest (Flona de Jamari). Biomass was estimated using the computeAGB function from the BIOMASS package, using the total height derived from retrieveH and the two wood density databases (the Global Wood Density Database and the Brazilian Wood Density Database). The BWD does not provide estimates of basic wood density for all species. When species-level values are unavailable, estimates from Global Wood Database will be used.\nEach point represents one year of measurement for a plot. I will highlight plots with biomass estimation out of limits of agreement.\n\nw_density_BR &lt;- left_join(w_density, \n                          bwd_biomass, \n                          by = c(\"species\",\n                                 \"genus\"), \n                          multiple = \"any\") %&gt;% \n                \n                mutate(wd = ifelse(!is.na(wd), \n                                   wd, \n                                   meanWD)) %&gt;% \n                select(family, \n                       genus, \n                       species, \n                       wd)\n\n\naltura &lt;- retrieveH(D = pps$diametrocm,\n                    coord = c(-62.99,\n                                   -9.11\n                                   ))\n\n\npps$altura &lt;- altura$H\n\npps$AGB_Global &lt;- computeAGB(D = pps$diametrocm,\n                             WD = w_density$meanWD,\n                             H = pps$altura)\n\npps$AGB_Brazilian &lt;- computeAGB(D = pps$diametrocm,\n                                WD = w_density_BR$wd,\n                                H = pps$altura)\n\npps$plot &lt;- paste(pps$UMF,pps$UPA,\n                  \"plot\",\n                  pps$p23_cdparcela,\n                  pps$p23_cdmedicao)\n\n\npps_plots &lt;- pps %&gt;% \n              group_by(plot,\n                       p23_cdmedicao) %&gt;% \n              summarise(\"AGB_Global\" = sum(AGB_Global),\n                        \"AGB_Brazilian\" = sum(AGB_Brazilian))\n\npps_plots$mean_density &lt;- (pps_plots$AGB_Global + pps_plots$AGB_Brazilian) / 2\npps_plots$diff_density &lt;- pps_plots$AGB_Global - pps_plots$AGB_Brazilian\n\nbias &lt;- mean(pps_plots$diff_density, \n             na.rm = TRUE)\nsd_diff &lt;- sd(pps_plots$diff_density, \n              na.rm = TRUE)\n\nloa_inf &lt;- bias - 1.96 * sd_diff\nloa_sup &lt;- bias + 1.96 * sd_diff\n\npps_plots &lt;- pps_plots %&gt;%\n            mutate(fora_loa = diff_density &lt; loa_inf | diff_density &gt; loa_sup)\n\n\nggplot(pps_plots, aes(x = mean_density, \n                      y = diff_density,\n                      color = plot)) +\n  geom_point(alpha = 0.7) +\n  geom_hline(yintercept = mean(pps_plots$diff_density,\n                               na.rm = TRUE),\n             linetype = \"dashed\") +\n  geom_hline(yintercept = mean(pps_plots$diff_density,\n                               na.rm = TRUE) +\n                           1.96 * sd(pps_plots$diff_density,\n                                     na.rm = TRUE),\n             linetype = \"dotted\") +\n  geom_hline(yintercept = mean(pps_plots$diff_density,\n                               na.rm = TRUE) -\n                           1.96 * sd(pps_plots$diff_density,\n                                     na.rm = TRUE),\n             linetype = \"dotted\") +\n    geom_text_repel(\n    data = subset(pps_plots, \n                  fora_loa),\n    aes(label = plot),\n    size = 3,\n    show.legend = FALSE\n  ) +\n  labs(\n    x = \"Mean plot AGB\",\n    y = \"Difference between methods\",\n    title = \"Bland-Altman: Plot AGB estimates with different wood density databases\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n\nChave, Jerome, David Coomes, Steven Jansen, Simon L. Lewis, Nathan G. Swenson, and Amy E. Zanne. 2009. ‚ÄúTowards a Worldwide Wood Economics Spectrum.‚Äù Ecology Letters 12: 351‚Äì66. https://doi.org/10.1111/j.1461-0248.2009.01285.x.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Comparing wood density databases</span>"
    ]
  },
  {
    "objectID": "../gustavo_with_Lidar_H.html",
    "href": "../gustavo_with_Lidar_H.html",
    "title": "3¬† Gustavo",
    "section": "",
    "text": "4 Lecture\n\nAbout tree height allometry: Molto et al. (2014)\nTALLO database: Jucker et al. (2022)\ncmdstanr installation: https://mc-stan.org/cmdstanr/articles/cmdstanr.html\nstan programming: https://mc-stan.org/\n\n\n\n5 Setup\nYou only need the tidyverse package for table manipulation and figures preparation, cmdstanr, brms, and bayesplot for Bayesian statistics.\n\nlibrary(tidyverse)\nlibrary(cmdstanr)\nlibrary(brms)\nlibrary(bayesplot)\nlibrary(here)\n\n\n\n6 Data\nData are tree hight and diameter from the TALLO database (Jucker et al. 2022) itself using dos-Santos et al. (2022) data for Jamari. Longitude and latitude are in degrees, so 1 degree is about 110 km at the equator, and we use a buffer of 10km. We have a total of 974 individuals and 134 species.\n\nlon &lt;- -62.99\nlat &lt;- -9.11\nbuffer &lt;- 10/110\ndata &lt;- read_csv(here(\"data/forest_inventory/tallo.csv\")) %&gt;% \n  filter(longitude &gt;= lon-buffer, longitude &lt;= lon+buffer,\n          latitude &gt;= lat-buffer, latitude &lt;= lat+buffer) %&gt;% \n  mutate(species = paste(genus, species)) %&gt;% \n  select(tree_id, species, height_m, stem_diameter_cm)\nggplot(data, aes(stem_diameter_cm, height_m)) +\n  geom_point(aes(col = species), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth(se = FALSE) +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\") +\n  ggtitle(paste(nrow(data), \"individuals\"),\n          \n          paste(unique(data$species) %&gt;% length(),\n                \"species\"))\n\n\n\n\n\n\n\n\nLet‚Äôs see if data from dos-Santos et al. (2022) area the same. Filter only tree (type == ‚ÄúO‚Äù) and alive (dead == ‚ÄúA‚Äù).\n\ndos_santos &lt;- list.files(here(\"data/forest_inventory\"),\n                          pattern = \"^JAM.*\\\\.csv$\",\n                          full.names = T)\n\ndos_santos_df &lt;- dos_santos %&gt;% \n                        purrr::map_df(~ read_csv(.x, \n                                      show_col_types = FALSE, \n                                      col_types = cols(.default = col_character()))) %&gt;%\n                               filter(type == \"O\" ,\n                                      dead == \"A\",\n                                      !is.na(transect))\n\nggplot(dos_santos_df, aes(as.numeric(DBH), as.numeric(Htot))) +\n  geom_point(aes(col = scientific_name), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth(se = FALSE) +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\") +\n  ggtitle(paste(nrow(dos_santos_df), \"individuals\"),\n          paste(unique(dos_santos_df$scientific_name) %&gt;% length(),\n                \"species\"))\n\n\n\n\n\n\n\n\nLet‚Äôs see Brazilian National Forest Inventory data on Flona de Jamari. We will load the full inventory from Rond√¥nia state and then we filter only the four plots inside Flona de Jamari (plots RO_74, RO_75, RO_95, RO_96)\n\nifn_data &lt;- read.csv2(here(\"data/forest_inventory/IFN_DAP10_Rond√¥nia_disp-set2025.csv\"),\n                      dec = \",\")\n\nifn_data_jamari &lt;- subset(ifn_data,\n                          ua == \"RO_74\" | ua == \"RO_75\" | ua == \"RO_95\" | ua == \"RO_96\")\n\nggplot(ifn_data_jamari, aes(as.numeric(dap), ht)) +\n  geom_point(aes(col = scientific_name), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth(se = FALSE) +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\") +\n  ggtitle(paste(nrow(ifn_data_jamari), \"individuals\"),\n          paste(unique(ifn_data_jamari$scientific_name) %&gt;% length(),\n                \"species\"))\n\n\n\n\n\n\n\n\nMerging two datasets (Dos Santos and IFN) in a standardized data frame.\n\ndf1_clean &lt;- dos_santos_df %&gt;%\n  select(scientific_name, DBH, Htot) %&gt;%\n  mutate(DBH = as.numeric(DBH),\n         Htot = as.numeric(Htot),\n         source = \"dos_santos\") %&gt;%\n  rename(\n    dbh = DBH,\n    total_height = Htot\n  )\n\ndf2_clean &lt;- ifn_data_jamari %&gt;%\n  select(scientific_name, dap, ht) %&gt;%\n  mutate(dap = as.numeric(dap),\n         source = \"IFN\") %&gt;%\n  rename(\n    dbh = dap,\n    total_height = ht\n  )\n\n\njam_for_inv &lt;- bind_rows(df1_clean, df2_clean)\n\n\nggplot(jam_for_inv, aes(dbh, total_height)) +\n  geom_point(aes(col = scientific_name), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth(se = FALSE) +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\") +\n  ggtitle(paste(nrow(jam_for_inv), \"individuals\"),\n          paste(unique(jam_for_inv$scientific_name) %&gt;% length(),\n                \"species\"))\n\n\n\n\n\n\n\n\n\n\n7 Model\nWe model tree height \\(h\\) in function of tree diameter \\(d\\) as:\n\\[\nh \\sim logN( \\frac{h_{max}\\times d}{a + d} , \\sigma)\n\\]\nwith \\(h_{max}\\) the maximum tree height and \\(a\\).\n\n\n8 Example with cmdstanr\n\nmdata &lt;- list(\n  N = nrow(jam_for_inv),\n  h = jam_for_inv$total_height,\n  d = jam_for_inv$dbh\n)\nmodel &lt;- cmdstan_model(\"gustavo.stan\")\nmodel\n\ndata {\n  int&lt;lower=0&gt; N;\n  vector[N] h;\n  vector[N] d;\n}\nparameters {\n  real&lt;lower=1, upper=100&gt; hmax;\n  real&lt;lower=0&gt; a;\n  real&lt;lower=0&gt; sigma;\n}\nmodel {\n  log(h) ~ normal(log(hmax*d ./ (a+d)), sigma);\n}\n\n\n\nfit &lt;- model$sample(data = mdata, parallel_chains = 4,\n                    show_messages = FALSE, show_exceptions = FALSE)\nfit\n\n variable   mean median   sd  mad     q5    q95 rhat ess_bulk ess_tail\n    lp__  880.30 880.59 1.14 0.97 878.13 881.56 1.00     1407     1638\n    hmax   41.87  41.79 1.48 1.47  39.56  44.38 1.00     1183     1440\n    a      26.32  26.26 1.59 1.58  23.87  29.09 1.00     1204     1417\n    sigma   0.37   0.37 0.01 0.01   0.36   0.38 1.00     1891     1812\n\n\n\nfit$draws(c(\"hmax\", \"a\")) %&gt;%\n  mcmc_hist()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n\nggplot(jam_for_inv, aes(dbh, total_height)) +\n  geom_point(col = \"lightgrey\") +\n  stat_function(fun = function(x) 54.50*x/(33.90+x)) +\n  theme_bw() +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\") +\n  ggtitle(paste(nrow(jam_for_inv), \"individuals\"),\n          paste(unique(jam_for_inv$scientific_name) %&gt;% length(),\n                \"species\"))\n\n\n\n\n\n\n\n\n\n\n9 Example with brms\n\nfit &lt;- brm(bf(log(h) ~ log(hmax * d/ (a + d)),\n              hmax ~ 1, a ~ 1,\n              nl = TRUE),\n           prior = c(\n             prior(uniform(0, 100), lb = 10, nlpar = \"hmax\"),\n             prior(uniform(0, 100), lb = 0, nlpar = \"a\")\n             ),\n           data = mdata, chains = 4, cores = 4)\nfit\n\n\n\n10 References\n\n\n\n\ndos-Santos, M. N., M. M. Keller, E. R. Pinage, and D. C. Morton. 2022. ‚ÄúForest Inventory and Biophysical Measurements, Brazilian Amazon, 2009-2018.‚Äù https://doi.org/10.3334/ORNLDAAC/2007.\n\n\nJucker, Tommaso, Fabian J√∂rg Fischer, J√©r√¥me Chave, David A. Coomes, John Caspersen, Arshad Ali, Grace Jopaul Loubota Panzou, et al. 2022. ‚ÄúTallo: A Global Tree Allometry and Crown Architecture Database.‚Äù Global Change Biology 28 (September): 5254‚Äì68. https://doi.org/10.1111/gcb.16302.\n\n\nMolto, Q., B. H√©rault, J. J. Boreux, M. Daullet, A. Rousteau, and V. Rossi. 2014. ‚ÄúPredicting Tree Heights for Biomass Estimates in Tropical Forests -a Test from French Guiana.‚Äù Biogeosciences 11 (June): 3121‚Äì30. https://doi.org/10.5194/bg-11-3121-2014.",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Gustavo</span>"
    ]
  },
  {
    "objectID": "../estimate_biomass.html",
    "href": "../estimate_biomass.html",
    "title": "4¬† estimate_biomass_H_lidar",
    "section": "",
    "text": "5 This script\nThis is a script to estimate Above Ground Biomass (AGB) of a given Annual Production Unit in Jamari Forest Concession using two different total heights estimations: one obtained from Lidar (see https://gbediaga.github.io/Jamari/tree_height_from_lidar.html), and other obtained from rerieveH function from BIOMASS package (R√©jou-M√©chain et al. (2017)).\nWe will also estimate biomass with only DBH using three different equations: Chave et al. (2014), Nogueira et al. (2008) and Melo et al. (2024).\nWe will then compare the results.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>estimate_biomass_H_lidar</span>"
    ]
  },
  {
    "objectID": "../estimate_biomass.html#load-the-inventory",
    "href": "../estimate_biomass.html#load-the-inventory",
    "title": "4¬† estimate_biomass_H_lidar",
    "section": "8.1 Load the Inventory",
    "text": "8.1 Load the Inventory\nLet‚Äôs load the Commercial Forest Inventory with the different height estimations.\n\n#if100 &lt;- read.csv(\"C:/Gustavo/Doutorado/Dados/UPAS da pesquisa/Jamari/Sylvain/Data/if100_pts_z.csv\")\nif100 &lt;- read.csv(here(\"data/output/all_tables.csv\"))",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>estimate_biomass_H_lidar</span>"
    ]
  },
  {
    "objectID": "../estimate_biomass.html#estimating-biomass-with-total-height",
    "href": "../estimate_biomass.html#estimating-biomass-with-total-height",
    "title": "4¬† estimate_biomass_H_lidar",
    "section": "11.1 Estimating biomass with total height",
    "text": "11.1 Estimating biomass with total height\nWe estimated only some of the commercial species tree height using Lidar. We will remove all trees without Lidar estimated height, so we can compare AGB estimates. We need a new taxo for the reduced data frame.\n\nif100.red &lt;- if100[!is.na(if100$z_lidar), ]\n\ntaxo.red &lt;- correctTaxo(genus=if100.red$genus,\n                        species=if100.red$epithet,\n                        useCache = F)\n\nThen we get the wood density of each species.\n\nw_density.red &lt;- getWoodDensity(genus = taxo.red$genusCorrected,\n                                species = taxo.red$speciesCorrected)\n\nCompute AGB with Chave et al. (2014) equation and Feldpausch et al. (2011) height.\n\nif100.red$AGB_chave_feld &lt;- computeAGB(D = if100.red$dap,\n                                       WD = w_density.red$meanWD,\n                                       H = if100.red$altura_feld)\n# AGB = 0.0673 * (WD * H * D^2)^0.976\n\nCompute AGB with Chave et al. (2014) equation and Lidar height.\n\nif100.red$AGB_chave_lidar &lt;- computeAGB(D = if100.red$dap,\n                                        WD = w_density.red$meanWD,\n                                        H = if100.red$z_lidar)\n# AGB = 0.0673 * (WD * H * D^2)^0.976\n\nNow let‚Äôs compare the different AGB estimates.\n\nggplot(if100.red, \n       aes(x = AGB_chave_lidar, \n           y = AGB_chave_feld)) +\n  geom_point(alpha = 0.7, \n             aes(color = nome_cientifico),\n             show.legend = F) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\",\n              formula = 'y ~ 0 + x') +\n  theme_minimal() +\n  labs(\n    title = \"AGB with Feldpausch height x AGB with Lidar height\",\n    x = \"Lidar AGB (Mg)\",\n    y = \"Feldpausch AGB (Mg)\"#,\n    #color = \"Species\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"),\n    legend.title = element_text(face = \"bold\")#,\n    #legend.text = element_text(size = 6)\n  ) +\n  ggpubr::stat_regline_equation(formula = 'y ~ 0 + x')\n\n\n\n\n\n\n\n\nIs the difference between the biomass estimates different across the DBHs? Comparing AGB estimates with different heights estimates across DBHs.\n\nif100.red$diff_agbs_h &lt;- if100.red$AGB_chave_feld - if100.red$AGB_chave_lidar\n\nggplot(if100.red, \n       aes(x = dap, \n           y = diff_agbs_h)) +\n  geom_point(alpha = 0.5, \n             aes(color = nome_cientifico),\n             show.legend = F) +\n  geom_hline(yintercept = 0, \n             linetype = \"dashed\") +\n  theme_minimal() +\n  labs(x = \"DAP\", y = \"Difference (AGB with H by Feldpausch ‚àí AGB with H by Lidar)\",\n       title = \"AGB estimations difference by DBH\")+\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"))",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>estimate_biomass_H_lidar</span>"
    ]
  },
  {
    "objectID": "../estimate_biomass.html#estimating-biomass-using-only-dbh",
    "href": "../estimate_biomass.html#estimating-biomass-using-only-dbh",
    "title": "4¬† estimate_biomass_H_lidar",
    "section": "11.2 Estimating biomass using only DBH",
    "text": "11.2 Estimating biomass using only DBH\nWe will use Chave et al. (2014), Nogueira et al. (2008) e Melo et al. (2024) equations to estimate AGB using only DBH.\nIt is important to point out that Nogueira et al. (2008) and Melo et al. (2024) uses only DBH, whereas Chave et al. (2014) uses, in addition to DBH, wood density and a variable representing environmental stress (see R√©jou-M√©chain et al. (2017) for the minor modification in Chave et al. (2014) equation used in BIOMASS).\n\nif100$AGB_chave_dbh &lt;- computeAGB(D = if100$dap,\n                                  WD = w_density$meanWD,\n                                  coord = c(-62.99,\n                                            -9.11))\n# AGB =  exp(-2,024 - 0,896 * E + 0,920 * ln(WD) + 2,795 * ln(DAP) - 0,0461 * [ln(DAP)^2])\n\nif100$AGB_nog_dbh &lt;- (exp(-1.716 + 2.413 * log(if100$dap))) / 1000\n# We have to divide results by 1000 because equation gives AGB in kg\n\nif100$AGB_melo_dbh &lt;- (0.064 * (if100$dap^2.671) + 3.69) / 1000\n# We have to divide results by 1000 because equation gives AGB in kg\n\nTo plot the three equations results in the same graph, we must convert data to LONG format.\n\ndf_long &lt;- if100 |&gt;\n  pivot_longer(\n    cols = c(AGB_chave_dbh, AGB_nog_dbh, AGB_melo_dbh),\n    names_to = \"equation\",\n    values_to = \"biomass\"\n  )\n\nNow let‚Äôs plot them.\n\nggplot(df_long, \n       aes(x = dap, \n           y = biomass, \n           color = equation)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(method = \"lm\",\n              se = FALSE, \n              linewidth = 1.2,\n              formula = 'y ~ 0 + x') +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 12, \n                              face = \"bold\"),\n    legend.title = element_text(face = \"bold\")#,\n    #legend.text = element_text(size = 6)\n  ) +\n  labs(\n    title = \"Biomass‚ÄìDBH Relationships Derived from Multiple Allometric Models\",\n    x = \"DBH (cm)\",\n    y = \"Biomass (Mg)\",\n    color = \"Equation\"\n  )\n\n\n\n\n\n\n\n\nNow let‚Äôs compare the different AGB estimates.\n\nggplot(if100, \n       aes(x = AGB_chave_dbh, \n           y = AGB_nog_dbh)) +\n  geom_point(alpha = 0.7, \n             aes(color = nome_cientifico),\n             show.legend = F) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\",\n              formula = 'y ~ 0 + x') +\n  theme_minimal() +\n  labs(\n    title = \"AGB Chave eq. (DBH) x AGB Nogueira eq. (DBH)\",\n    x = \"Chave eq AGB (Mg)\",\n    y = \"Nogueira eq AGB (Mg)\"#,\n    #color = \"Species\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"),\n    legend.title = element_text(face = \"bold\")#,\n    #legend.text = element_text(size = 6)\n  ) +\n  ggpubr::stat_regline_equation(formula = 'y ~ 0 + x')\n\n\n\n\n\n\n\n\nIs the difference between the biomass estimates different across the DBHs? Comparing Chave et al. (2014) x Nogueira et al. (2008) equations estimates across DBHs.\n\nif100$diff_agbs &lt;- if100$AGB_chave_dbh - if100$AGB_nog_dbh\n\nggplot(if100, \n       aes(x = dap, \n           y = diff_agbs)) +\n  geom_point(alpha = 0.5, \n             aes(color = nome_cientifico),\n             show.legend = F) +\n  geom_hline(yintercept = 0, \n             linetype = \"dashed\") +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"),\n    legend.title = element_text(face = \"bold\")#,\n    #legend.text = element_text(size = 6)\n  ) +\n  labs(x = \"DAP\", y = \"Difference (Chave ‚àí Nogueira)\",\n       title = \"AGB estimations difference by DBH\")+\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              size = 14, \n                              face = \"bold\"))",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>estimate_biomass_H_lidar</span>"
    ]
  },
  {
    "objectID": "../estimate_biomass.html#comparing-biomass-estimates-using-only-dbh-and-using-dbh-height",
    "href": "../estimate_biomass.html#comparing-biomass-estimates-using-only-dbh-and-using-dbh-height",
    "title": "4¬† estimate_biomass_H_lidar",
    "section": "11.3 Comparing biomass estimates using only DBH and using DBH + Height",
    "text": "11.3 Comparing biomass estimates using only DBH and using DBH + Height\nComparing AGB estimate using only DBH and using DBH + height obtained by Lidar. We will use results from Chave et al. (2014) equations (with and without height).\nTo plot the equations results in the same graph, we must convert data to LONG format.\n\nif100.red &lt;- left_join(\n                      if100.red,\n                      if100 %&gt;% select(id_arv,\n                                       AGB_chave_dbh, \n                                       AGB_nog_dbh, \n                                       AGB_melo_dbh),\n                      by = \"id_arv\"\n                      )\n\nWarning in left_join(if100.red, if100 %&gt;% select(id_arv, AGB_chave_dbh, : Detected an unexpected many-to-many relationship between `x` and `y`.\n‚Ñπ Row 531 of `x` matches multiple rows in `y`.\n‚Ñπ Row 2662 of `y` matches multiple rows in `x`.\n‚Ñπ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\nif100.red_long &lt;- if100.red |&gt;\n                  pivot_longer(\n                              cols = c(AGB_chave_dbh, \n                                       AGB_nog_dbh, \n                                       AGB_melo_dbh,\n                                       AGB_chave_feld,\n                                       AGB_chave_lidar),\n                              names_to = \"equation\",\n                              values_to = \"biomass\"\n                              )\n\nNow let‚Äôs plot\n\nggplot(if100.red_long, \n                aes(x = dap, \n                    y = biomass, \n                    color = equation)) +\n  geom_point(alpha = 0.3) +            # pontos opcionais\n  geom_smooth(method = \"lm\",\n              se = FALSE, \n              linewidth = 1.2)+#,\n #             formula = 'y ~ 0 + x') + # linhas das equa√ß√µes\n  theme_minimal() +\n  labs(\n    title = \"Biomass‚ÄìDBH Relationships Derived from Multiple Allometric Models\",\n    x = \"DBH (cm)\",\n    y = \"Biomass (Mg)\",\n    color = \"Equation\"\n  )\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\n\n\nChave, J√©r√¥me, Maxime R√©jou-M√©chain, Alberto B√∫rquez, Emmanuel Chidumayo, Matthew S. Colgan, Welington B. C. Delitti, Alvaro Duque, et al. 2014. ‚ÄúImproved Allometric Models to Estimate the Aboveground Biomass of Tropical Trees.‚Äù Global Change Biology 20: 3177‚Äì90. https://doi.org/10.1111/gcb.12629.\n\n\nFeldpausch, T. R., L. Banin, O. L. Phillips, T. R. Baker, S. L. Lewis, C. A. Quesada, K. Affum-Baffoe, et al. 2011. ‚ÄúHeight-Diameter Allometry of Tropical Forest Trees.‚Äù Biogeosciences 8: 1081‚Äì1106. https://doi.org/10.5194/bg-8-1081-2011.\n\n\nFischer, Fabian J√∂rg, Toby Jackson, Gr√©goire Vincent, and Tommaso Jucker. 2024. ‚ÄúRobust Characterisation of Forest Structure from Airborne Laser Scanning‚Äîa Systematic Assessment and Sample Workflow for Ecologists.‚Äù Methods in Ecology and Evolution 15 (October): 1873‚Äì88. https://doi.org/10.1111/2041-210X.14416.\n\n\nMelo, Antonio Willian Flores de, Adriano Jos√© Nogueira Lima, Marcus Vinicio Neves d‚ÄôOliveira, Joaquim dos Santos, I. Foster Brown, Eufran Ferreira do Amaral, Sonaira Souza da Silva, Igor Oliveira, Pl√≠nio Barbosa de Camargo, and Niro Higuchi. 2024. ‚ÄúTo Improve Estimates of Neotropical Forest Carbon Stocks More Direct Measurements Are Needed: An Example from the Southwestern Amazon.‚Äù Forest Ecology and Management 570 (October). https://doi.org/10.1016/j.foreco.2024.122195.\n\n\nNogueira, Euler Melo, Philip Martin Fearnside, Bruce Walker Nelson, Reinaldo Imbrozio Barbosa, and Edwin Willem Hermanus Keizer. 2008. ‚ÄúEstimates of Forest Biomass in the Brazilian Amazon: New Allometric Equations and Adjustments to Biomass from Wood-Volume Inventories.‚Äù Forest Ecology and Management 256 (November): 1853‚Äì67. https://doi.org/10.1016/j.foreco.2008.07.022.\n\n\nR√©jou-M√©chain, Maxime, Ariane Tanguy, Camille Piponiot, J√©r√¥me Chave, and Bruno H√©rault. 2017. ‚ÄúBiomass: An r Package for Estimating Above-Ground Biomass and Its Uncertainty in Tropical Forests.‚Äù Methods in Ecology and Evolution 8 (September): 1163‚Äì67. https://doi.org/10.1111/2041-210X.12753.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>estimate_biomass_H_lidar</span>"
    ]
  },
  {
    "objectID": "scripts.html",
    "href": "scripts.html",
    "title": "2¬† Reports",
    "section": "",
    "text": "2.0.1 üå≤ Tree height from LiDAR\nEstimation of tree height using LiDAR and field data.\nOpen report ‚Üí",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Reports</span>"
    ]
  },
  {
    "objectID": "scripts.html#tree-height-from-lidar-1",
    "href": "scripts.html#tree-height-from-lidar-1",
    "title": "2¬† Reports",
    "section": "2.1 üå≤ Tree height from LiDAR",
    "text": "2.1 üå≤ Tree height from LiDAR\nEstimation and validation of tree height derived from LiDAR data using field measurements.\n‚û°Ô∏è Open report",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Reports</span>"
    ]
  },
  {
    "objectID": "scripts.html#wood-density-databases",
    "href": "scripts.html#wood-density-databases",
    "title": "2¬† Reports",
    "section": "2.2 ü™µ Wood density databases",
    "text": "2.2 ü™µ Wood density databases\nComparison and harmonization of global and Brazilian wood density datasets.\n‚û°Ô∏è Open report",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Reports</span>"
    ]
  },
  {
    "objectID": "scripts.html#biomass-estimation",
    "href": "scripts.html#biomass-estimation",
    "title": "2¬† Reports",
    "section": "2.3 üå≥ Biomass estimation",
    "text": "2.3 üå≥ Biomass estimation\nAboveground biomass estimation using allometric equations and LiDAR metrics.\n‚û°Ô∏è Open report",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Reports</span>"
    ]
  },
  {
    "objectID": "scripts.html#lidar-derived-canopy-height-model",
    "href": "scripts.html#lidar-derived-canopy-height-model",
    "title": "2¬† Reports",
    "section": "2.4 üöÅ LiDAR-derived canopy height model",
    "text": "2.4 üöÅ LiDAR-derived canopy height model\nExploratory analysis of CHM data and spike filtering.\n‚û°Ô∏è Open report",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Reports</span>"
    ]
  }
]